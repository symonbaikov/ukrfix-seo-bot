# Техническое описание стека и интеграций бота Programmatic SEO

## 1. Основной стек

- **Язык**: Python 3.x
- **Запуск**: standalone script / VPS / cron
- **База данных**: SQLite (файл `history.db`)
- **Формат окружения**: `.env`
- **Тип бота**: Programmatic SEO генератор контента

## 2. Основные интеграции

### 2.1. OpenAI API

- Используется для генерации статей
- **Модель**: `gpt-4o`
- **Формат ответа**: HTML-контент
- **Передаваемые данные**:
  - тема статьи
  - собранный контекст из Google
  - структура SEO-статьи

### 2.2. Pexels API

- Поиск изображений по ключевым словам (category mapping)
- Получение large-изображений
- Используется как источник бесплатных легальных фото

### 2.3. WordPress REST API

- **Авторизация**: Application Password
- **Методы**:
  - `/wp-json/wp/v2/media` — загрузка изображений
  - `/wp-json/wp/v2/posts` — публикация статей
- **Параметры публикации**:
  - `title`
  - `content` (HTML)
  - `featured_media` (ID изображения)
  - `status=publish`

### 2.4. Google Search (google-search-python)

- Легкий парсер выдачи Google
- Извлекает 2–3 описания конкурирующих сайтов для контекста

## 3. Логика работы бота

1. Выбор случайной комбинации (страна → город → категория)
2. Проверка на дубли через SQLite
3. Поиск изображений по категории
4. Генерация SEO-статьи через OpenAI
5. Публикация результата в WordPress
6. Запись комбинации в базу
7. Ожидание 80–100 минут
8. Повтор цикла

## 4. Структура данных

### Словари конфигурации

- **LOCATIONS** (страны → города)
- **CATEGORIES** (категория → поисковый запрос для Pexels)

### База данных

- **SQLite таблица `posted`** (country, city, category)

### ENV переменные

```env
WP_URL
WP_USERNAME
WP_APP_PASSWORD
OPENAI_API_KEY
PEXELS_API_KEY
```